Workflow
=====

Running **JUNE_NZ** involves three main steps:

- Step 1: Creating the input dataset.
- Step 2: Running the model.
- Step 3: Generating the model diagnosis.

Each step utilizes the output generated by the previous step as input.


**********
Step 1. Creating the input dataset
**********

The wrapper for creating the input dataset is ``cli/cli_data.py``, which can be triggered as:

.. code-block:: python

    python cli_data.py --workdir <WORKING DIRECTORY>
                       --cfg etc/cfg/run/june_singleobs_v2.0.yml
                       [--scale <POPULATION PERCENTAGE>]
                       [--disease_cfg_dir <DISEASE CONFIGURATION DIRECTORY>]
                       [--policy_cfg_path <POLICY CONFIGURATION FILE>]
                       [--vaccine_cfg_path <VACCINATION CAMPAIGN CONFIGURATION FILE>]
                       [--simulation_cfg_path <SIMULATION CONFIGURATION FILE>]
                       [--use_sa3_as_super_area]

where:

    - ``--workdir``: Working directory.
    - ``--cfg``: Data configuration.
    - ``--scale``: Population percentage to be used in the model (e.g., 0.1 means that we only use 10% of NZ population).
    - ``--disease_cfg_dir``: Disease configuration directory, which must contain population comorbidities, infection probability, infection outcome, symptom trajectory and virus intensity.
    - ``--policy_cfg_path``: Policy configuration file.
    - ``--vaccine_cfg_path``: Vaccine compaign configuration file.
    - ``--simulation_cfg_path``: Simulation configuration file.
    - ``--use_sa3_as_super_area``: If using SA3 as super area, otherwise use the regional councils.

For example, the input data can be created by:

.. code-block:: python

    python cli_data.py --workdir etc/data/realworld_auckland --cfg etc/cfg/run/june_data.yml --scale 0.1 --disease_cfg_dir etc/cfg/disease/covid-19 --policy_cfg_path etc/cfg/policy/policy1.yaml --vaccine_cfg_path etc/cfg/disease/vaccine/vaccine1.yaml --simulation_cfg_path etc/cfg/simulation/simulation_cfg.yml --use_sa3_as_super_area
